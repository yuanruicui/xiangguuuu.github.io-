<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多语言内容展示工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f8f9fa;
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --accent-blue: #0071e3;
            --accent-green: #34c759;
            --accent-orange: #ff9500;
            --accent-red: #ff3b30;
            --accent-purple: #9d4edd;
            --border-color: #d2d2d7;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.1);
            --card-radius: 18px;
            --element-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .dark-mode {
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --bg-tertiary: #252525;
            --text-primary: #f5f5f7;
            --text-secondary: #a1a1a6;
            --border-color: #424245;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.5s ease;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-green));
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            transition: all 0.5s ease;
        }

        .logo-icon i {
            color: white;
            font-size: 20px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 600;
            letter-spacing: -0.5px;
            transition: color 0.5s ease;
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: none;
            border-radius: var(--element-radius);
            width: 50px;
            height: 30px;
            position: relative;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }

        .toggle-circle {
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--bg-secondary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            left: 3px;
            transition: transform 0.3s ease;
        }

        .dark-mode .toggle-circle {
            transform: translateX(20px);
            background: var(--bg-tertiary);
        }

        .card {
            background: var(--bg-secondary);
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            padding: 28px;
            margin-bottom: 30px;
            transition: var(--transition);
            overflow: hidden;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: color 0.5s ease;
        }

        .card-title i {
            color: var(--accent-blue);
            font-size: 20px;
        }

        .card-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 5px;
            font-weight: 400;
        }

        .form-group {
            margin-bottom: 18px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        input, textarea, select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--border-color);
            border-radius: var(--element-radius);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 15px;
            transition: var(--transition);
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.15);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn {
            padding: 10px 16px;
            border-radius: var(--element-radius);
            border: none;
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: var(--transition);
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-secondary {
            background: var(--accent-green);
            color: white;
        }

        .btn-danger {
            background: var(--accent-red);
            color: white;
        }

        .btn-purple {
            background: var(--accent-purple);
            color: white;
        }

        .btn-orange {
            background: var(--accent-orange);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-group {
            display: flex;
            gap: 8px;
            margin-top: 18px;
            flex-wrap: wrap;
        }

        .language-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            max-height: 200px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--element-radius);
            background: var(--bg-tertiary);
        }

        .language-btn {
            padding: 8px 14px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--element-radius);
            cursor: pointer;
            transition: var(--transition);
            font-size: 13px;
            color: var(--text-primary);
        }

        .language-btn:hover {
            background: rgba(0, 113, 227, 0.1);
            border-color: var(--accent-blue);
        }

        .language-btn.active {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .content-display {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--element-radius);
            min-height: 200px;
            background: var(--bg-tertiary);
        }

        .content-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--accent-blue);
        }

        .content-body {
            white-space: pre-wrap;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .json-output {
            margin-top: 20px;
            padding: 20px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--element-radius);
            overflow-x: auto;
            font-family: 'SF Mono', Menlo, monospace;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .success-message {
            margin-top: 15px;
            padding: 12px 16px;
            background: var(--accent-green);
            color: white;
            border-radius: var(--element-radius);
            display: none;
            font-size: 14px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .file-upload {
            position: relative;
            margin-bottom: 20px;
        }

        .file-upload input {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload label {
            display: block;
            padding: 14px 16px;
            border: 2px dashed var(--border-color);
            border-radius: var(--element-radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload label:hover {
            border-color: var(--accent-blue);
            background: rgba(0, 113, 227, 0.05);
        }

        .file-upload i {
            font-size: 24px;
            margin-bottom: 8px;
            color: var(--accent-blue);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .language-selector {
                flex-direction: column;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-language"></i>
                </div>
                <div class="logo-text">多语言内容展示工具</div>
            </div>
            <div class="controls">
                <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                    <div class="toggle-circle"></div>
                </button>
            </div>
        </header>
        
        <div class="card fade-in" style="animation-delay: 0.1s;">
            <div class="card-header">
                <div>
                    <div class="card-title">
                        <i class="fas fa-plus-circle"></i>
                        添加新的语言内容
                    </div>
                    <div class="card-subtitle">添加或更新多语言内容</div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="languageCode">语言</label>
                <select id="languageCode">
                    <option value="1">1 - 简体中文</option>
                    <option value="2">2 - 繁体中文</option>
                    <option value="3">3 - 英语</option>
                    <option value="4">4 - 日语</option>
                    <option value="5">5 - 泰语</option>
                    <option value="6">6 - 阿拉伯语</option>
                    <option value="7">7 - 韩语</option>
                    <option value="8">8 - 印尼语</option>
                    <option value="9">9 - 西班牙语</option>
                    <option value="10">10 - 葡萄牙语</option>
                    <option value="11">11 - 越南语</option>
                    <option value="12">12 - 俄语</option>
                    <option value="13">13 - 土耳其语</option>
                    <option value="14">14 - 德语</option>
                    <option value="15">15 - 法语</option>
                    <option value="16">16 - 意大利语</option>
                    <option value="17">17 - 荷兰语</option>
                    <option value="18">18 - 波兰语</option>
                    <option value="19">19 - 印地语</option>
                    <option value="20">20 - 马来语</option>
                    <option value="21">21 - 菲律宾语</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="title">标题</label>
                <input type="text" id="title" placeholder="输入标题">
            </div>
            
            <div class="form-group">
                <label for="content">内容</label>
                <textarea id="content" placeholder="输入内容，使用Enter键换行"></textarea>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="addButton">
                    <i class="fas fa-plus"></i>
                    添加内容
                </button>
                <button class="btn btn-secondary" id="clearButton">
                    <i class="fas fa-eraser"></i>
                    清空表单
                </button>
                <button class="btn btn-danger" id="clearAllButton">
                    <i class="fas fa-trash"></i>
                    清空所有
                </button>
                <button class="btn btn-purple" id="copyButton">
                    <i class="fas fa-copy"></i>
                    复制JSON
                </button>
                <button class="btn btn-orange" id="exportButton">
                    <i class="fas fa-file-export"></i>
                    导出Excel
                </button>
            </div>
            
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i>
                内容添加成功！
            </div>
            <div class="success-message" id="copyMessage">
                <i class="fas fa-check-circle"></i>
                JSON复制成功！
            </div>
            <div class="success-message" id="clearAllMessage">
                <i class="fas fa-check-circle"></i>
                所有内容已清空！
            </div>
            <div class="success-message" id="exportMessage">
                <i class="fas fa-check-circle"></i>
                Excel导出成功！
            </div>
        </div>

        <div class="card fade-in" style="animation-delay: 0.2s;">
            <div class="card-header">
                <div>
                    <div class="card-title">
                        <i class="fas fa-file-import"></i>
                        批量导入多语言内容
                    </div>
                    <div class="card-subtitle">上传Excel文件导入多语言内容</div>
                </div>
            </div>
            
            <div class="file-upload">
                <input type="file" id="fileInput" accept=".xlsx,.xls">
                <label for="fileInput">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>点击或拖拽Excel文件到此处上传</p>
                    <small>支持.xlsx和.xls格式文件</small>
                </label>
            </div>
            
            <div class="success-message" id="importMessage">
                <i class="fas fa-check-circle"></i>
                批量导入成功！
            </div>
        </div>
        
        <div class="card fade-in" style="animation-delay: 0.3s;">
            <div class="card-header">
                <div>
                    <div class="card-title">
                        <i class="fas fa-globe"></i>
                        选择语言查看内容
                    </div>
                    <div class="card-subtitle">点击语言按钮查看对应内容</div>
                </div>
            </div>
            
            <div class="language-selector" id="languageSelector">
                <!-- 语言按钮将通过JavaScript动态生成 -->
            </div>
            
            <div class="content-display">
                <div class="content-title" id="contentTitle">请选择一种语言</div>
                <div class="content-body" id="contentBody"></div>
            </div>
        </div>
        
        <div class="card fade-in" style="animation-delay: 0.4s;">
            <div class="card-header">
                <div>
                    <div class="card-title">
                        <i class="fas fa-code"></i>
                        JSON数据
                    </div>
                    <div class="card-subtitle">所有语言内容的JSON格式</div>
                </div>
            </div>
            
            <div class="json-output" id="jsonOutput"></div>
        </div>
        
        <div class="footer">
            多语言内容展示工具 &copy; 2023
        </div>
    </div>

    <script>
        // 初始化多语言数据为空数组
        let multilingualData = [];

        // 语言代码到语言名称的映射
        const languageCodeToName = {
            1: "简体中文", 2: "繁体中文", 3: "英语", 4: "日语", 5: "泰语",
            6: "阿拉伯语", 7: "韩语", 8: "印尼语", 9: "西班牙语", 10: "葡萄牙语",
            11: "越南语", 12: "俄语", 13: "土耳其语", 14: "德语", 15: "法语",
            16: "意大利语", 17: "荷兰语", 18: "波兰语", 19: "印地语", 20: "马来语",
            21: "菲律宾语"
        };

        // 语言名称到代码的映射
        const languageNameToCode = {};
        for (const code in languageCodeToName) {
            languageNameToCode[languageCodeToName[code]] = parseInt(code);
        }

        /**
         * 初始化语言选择器
         * 动态生成语言按钮，并绑定点击事件
         */
        function initLanguageSelector() {
            const selector = document.getElementById('languageSelector');
            selector.innerHTML = ''; // 清空现有按钮
            
            if (multilingualData.length === 0) {
                selector.innerHTML = '<div style="padding: 10px; color: var(--text-secondary); text-align: center;">暂无语言内容，请先添加内容</div>';
                return;
            }
            
            multilingualData.forEach(item => {
                const button = document.createElement('button');
                button.className = 'language-btn';
                button.textContent = languageCodeToName[item.language] || `语言 ${item.language}`;
                button.setAttribute('data-language', item.language);
                button.addEventListener('click', () => {
                    document.querySelectorAll('.language-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    button.classList.add('active');
                    displayContent(item);
                });
                selector.appendChild(button);
            });
        }

        /**
         * 显示选中语言的内容
         * @param {Object} item - 包含语言、标题和内容的对象
         */
        function displayContent(item) {
            document.getElementById('contentTitle').textContent = item.title;
            document.getElementById('contentBody').textContent = item.content;
        }

        /**
         * 更新JSON输出，过滤空内容
         * 只显示标题和内容都不为空的语言数据
         */
        function updateJsonOutput() {
            const jsonOutput = document.getElementById('jsonOutput');
            // 过滤掉title或content为空的项
            const filteredData = multilingualData.filter(item => {
                return item.title && item.title.trim() !== '' && item.content && item.content.trim() !== '';
            });
            // 如果没有数据，显示提示信息
            if (filteredData.length === 0) {
                jsonOutput.textContent = '没有可用的语言数据，请添加内容后再试。';
            } else {
                // 格式化JSON，使用2个空格缩进
                jsonOutput.textContent = JSON.stringify(filteredData, null, 2);
            }
        }

        /**
         * 添加新的语言内容
         * 如果已有相同语言代码的内容，则更新；否则添加新内容
         */
        function addNewContent() {
            const languageCode = parseInt(document.getElementById('languageCode').value);
            const title = document.getElementById('title').value.trim();
            const content = document.getElementById('content').value.trim();

            if (!title || !content) {
                alert('请输入标题和内容');
                return;
            }

            // 检查是否已存在相同语言代码的内容
            const existingIndex = multilingualData.findIndex(item => item.language === languageCode);
            if (existingIndex !== -1) {
                // 更新现有内容
                multilingualData[existingIndex] = { language: languageCode, title, content };
            } else {
                // 添加新内容
                multilingualData.push({ language: languageCode, title, content });
                // 按语言代码排序
                multilingualData.sort((a, b) => a.language - b.language);
            }

            // 更新UI
            initLanguageSelector();
            updateJsonOutput();

            // 显示成功消息
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 2000);

            // 选中刚添加/更新的语言
            const newButton = document.querySelector(`.language-btn[data-language="${languageCode}"]`);
            if (newButton) {
                newButton.click();
            }
        }

        /**
         * 处理上传的Excel文件
         */
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // 获取第一个sheet
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                // 将sheet转换为JSON
                const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                
                // 处理导入的数据
                processImportedData(jsonData);
            };
            reader.readAsArrayBuffer(file);
        }

        /**
         * 处理导入的Excel数据
         * @param {Array} data - 导入的数据
         */
        function processImportedData(data) {
            let importCount = 0;
            
            data.forEach(item => {
                // 处理语言字段 - 可能是代码或名称
                let languageCode;
                if (typeof item.language === 'number') {
                    // 已经是代码
                    languageCode = item.language;
                } else if (typeof item.language === 'string') {
                    // 尝试将语言名称转换为代码
                    languageCode = languageNameToCode[item.language];
                }
                
                const title = item.title;
                const content = item.content;
                
                if (languageCode && title && content) {
                    // 检查是否已存在相同语言代码的内容
                    const existingIndex = multilingualData.findIndex(
                        dataItem => dataItem.language === languageCode
                    );
                    
                    if (existingIndex !== -1) {
                        // 更新现有内容
                        multilingualData[existingIndex] = { language: languageCode, title, content };
                    } else {
                        // 添加新内容
                        multilingualData.push({ language: languageCode, title, content });
                    }
                    importCount++;
                }
            });
            
            // 按语言代码排序
            multilingualData.sort((a, b) => a.language - b.language);

            // 更新UI
            initLanguageSelector();
            updateJsonOutput();

            // 显示导入成功消息
            const importMessage = document.getElementById('importMessage');
            importMessage.textContent = `批量导入成功！共 ${importCount} 条记录`;
            importMessage.style.display = 'block';
            setTimeout(() => {
                importMessage.style.display = 'none';
            }, 3000);
        }

        /**
         * 导出为Excel文件
         */
        function exportToExcel() {
            if (multilingualData.length === 0) {
                alert('没有可导出的数据');
                return;
            }

            // 创建工作簿
            const wb = XLSX.utils.book_new();
            
            // 准备数据 - 将语言代码转换为语言名称
            const excelData = multilingualData.map(item => ({
                language: languageCodeToName[item.language] || item.language,
                title: item.title,
                content: item.content,
                sender: "",
                footerDesc: "",
                footerUrl: ""
            }));
            
            // 添加表头
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            // 将工作表添加到工作簿
            XLSX.utils.book_append_sheet(wb, ws, "模板");
            
            // 生成Excel文件并下载
            XLSX.writeFile(wb, "多语言内容模板.xlsx");
            
            // 显示导出成功消息
            const exportMessage = document.getElementById('exportMessage');
            exportMessage.style.display = 'block';
            setTimeout(() => {
                exportMessage.style.display = 'none';
            }, 2000);
        }

        /**
         * 清空表单中的标题和内容输入框
         */
        function clearForm() {
            document.getElementById('title').value = '';
            document.getElementById('content').value = '';
        }

        /**
         * 清空所有语言内容
         * 弹出确认对话框，防止误操作
         */
        function clearAllContent() {
            if (confirm('确定要清空所有语言内容吗？此操作不可撤销！')) {
                multilingualData = [];
                // 更新UI
                initLanguageSelector();
                updateJsonOutput();
                document.getElementById('contentTitle').textContent = '请选择一种语言';
                document.getElementById('contentBody').textContent = '';

                // 显示清空成功消息
                const clearAllMessage = document.getElementById('clearAllMessage');
                clearAllMessage.style.display = 'block';
                setTimeout(() => {
                    clearAllMessage.style.display = 'none';
                }, 2000);
            }
        }

        /**
         * 复制JSON到剪贴板
         * 只在有有效数据时进行复制
         */
        function copyJsonToClipboard() {
            const jsonOutput = document.getElementById('jsonOutput');
            // 只复制有效的JSON数据
            if (jsonOutput.textContent !== '没有可用的语言数据，请添加内容后再试。') {
                navigator.clipboard.writeText(jsonOutput.textContent)
                    .then(() => {
                        // 显示复制成功消息
                        const copyMessage = document.getElementById('copyMessage');
                        copyMessage.style.display = 'block';
                        setTimeout(() => {
                            copyMessage.style.display = 'none';
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('复制失败:', err);
                        alert('复制失败，请手动复制');
                    });
            } else {
                alert('没有可用的语言数据，请添加内容后再试。');
            }
        }

        // 主题切换功能
        function setupThemeToggle() {
            const themeToggle = document.getElementById('themeToggle');
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
            
            // 检查本地存储或系统偏好
            if (localStorage.getItem('theme') === 'dark' || 
                (!localStorage.getItem('theme') && prefersDarkScheme.matches)) {
                document.body.classList.add('dark-mode');
            }
            
            // 切换主题
            themeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            initLanguageSelector();
            updateJsonOutput();
            setupThemeToggle();

            // 添加事件监听器
            document.getElementById('addButton').addEventListener('click', addNewContent);
            document.getElementById('clearButton').addEventListener('click', clearForm);
            document.getElementById('clearAllButton').addEventListener('click', clearAllContent);
            document.getElementById('copyButton').addEventListener('click', copyJsonToClipboard);
            document.getElementById('exportButton').addEventListener('click', exportToExcel);
            document.getElementById('fileInput').addEventListener('change', handleFileUpload);
        });
    </script>
</body>
</html>